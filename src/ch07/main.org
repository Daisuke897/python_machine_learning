*アンサンブル学習 異なるモデルの組み合わせ*

#+begin_src emacs-lisp
  (pyvenv-activate "~/project/python_machine_learning")
#+end_src

#+RESULTS:

* アンサンブルによる学習
ベース分類器のアンサンブルの誤分類率を二項分布の確率質量関数として簡単に表せる。

#+begin_src python :session :results value
  from scipy.special import comb
  import math
  def ensemble_error(n_classifier, error):
      k_start = int(math.ceil(n_classifier / 2.))
      probs = [comb(n_classifier, k) * error ** k * (1 - error) ** (n_classifier - k) for k in range(k_start, n_classifier + 1)]
      return sum(probs)

  ensemble_error(n_classifier = 11, error = 0.25)

#+end_src

#+RESULTS:
: 0.03432750701904297

#+begin_src python :session :results file link
  import numpy as np
  import matplotlib.pyplot as plt

  error_range = np.arange(0.0, 1.01, 0.01)
  ens_errors = [ensemble_error(n_classifier = 11, error = error) for error in error_range]
  plt.close("all")
  plt.plot(error_range, ens_errors, label = "Ensemble error", linewidth = 2)
  plt.plot(error_range, error_range, linestyle = "--", label = "Base error", linewidth = 2)
  plt.xlabel("Base error")
  plt.ylabel("Base/Ensemble error")
  plt.legend(loc = "upper left")
  plt.grid(alpha = 0.5)

  fname = "images/07_03.png"
  plt.savefig(fname)
  fname
#+end_src

#+RESULTS:
[[file:images/07_03.png]]
